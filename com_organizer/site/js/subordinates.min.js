"use strict";function addRow(){const table=document.getElementById("so-table"),order=table.rows.length,prefix="sub"+order,row=table.insertRow(),resource=row.insertCell(),ordering=row.insertCell();let resourceHTML,orderingHTML;row.className="subRow"+order;resource.className="sub-name";ordering.className="sub-order";resourceHTML='<span id="'+prefix+'Icon" class="far fa-square"></span>';resourceHTML+='<span id="'+prefix+'Name">'+Joomla.JText._("ORGANIZER_EMPTY_PANEL")+"</span>";resourceHTML+='<input id="'+prefix+'" type="hidden" value="" name="'+prefix+'">';resource.innerHTML=resourceHTML;orderingHTML=getButton("setFirst","fa fa-fast-backward",order,Joomla.JText._("ORGANIZER_MAKE_FIRST"));orderingHTML+=getButton("moveUp","fa fa-step-backward",order,Joomla.JText._("ORGANIZER_MOVE_UP"));orderingHTML+='<input type="text" name="'+prefix+'Order" ';orderingHTML+='id="'+prefix+'Order" size="2" value="'+order+'" ';orderingHTML+='onchange="moveTo('+order+');">';orderingHTML+=getButton("insertBlank","far fa-plus-square",order,Joomla.JText._("ORGANIZER_ADD_EMPTY_PANEL"));orderingHTML+=getButton("trash","fa fa-times",order,Joomla.JText._("ORGANIZER_DELETE"));orderingHTML+=getButton("moveDown","fa fa-step-forward",order,Joomla.JText._("ORGANIZER_MOVE_DOWN"));orderingHTML+=getButton("setLast","fa fa-fast-forward",order,Joomla.JText._("ORGANIZER_MAKE_LAST"));ordering.innerHTML=orderingHTML}function cloneSubOrdinate(row,subOrdinate){const so="sub"+row;document.getElementById(so).value=subOrdinate.id;document.getElementById(so+"Icon").className=subOrdinate.class;document.getElementById(so+"Name").textContent=subOrdinate.name;document.getElementById(so+"Order").value=row}function getButton(fName,iconClass,order,tip){const className=' class="btn btn-primary"',icon='<span class="'+iconClass+'"></span>',onClick='onclick="'+fName+"("+order+');"',type=' type="button"';tip=' title="'+tip+'"';return"<button"+className+onClick+tip+type+">"+icon+"</button>"}function getSubOrdinates(){const count=document.getElementById("so-table").rows.length-1,subordinates=[];let index,so;for(index=1;index<=count;index++){so="sub"+index;subordinates[index]={};subordinates[index].class=document.getElementById(so+"Icon").className.trim();subordinates[index].name=document.getElementById(so+"Name").textContent.trim();subordinates[index].id=document.getElementById(so).value;subordinates[index].order=document.getElementById(so+"Order").value}return subordinates}function insertBlank(at){let blank,subOrdinates;addRow();subOrdinates=getSubOrdinates();blank=subOrdinates[subOrdinates.length-1];shiftUp(subOrdinates.length-1,at,subOrdinates);cloneSubOrdinate(at,blank)}function moveDown(currentNo){const subOrdinates=getSubOrdinates();let current,next;currentNo=Number(currentNo);if(currentNo>=subOrdinates.length||subOrdinates.length===currentNo+1&&subOrdinates[currentNo-1].id===""){return}current=subOrdinates[currentNo];next=subOrdinates[currentNo+1];cloneSubOrdinate(currentNo,next);cloneSubOrdinate(currentNo+1,current)}function moveTo(currentNo){const subOrdinates=getSubOrdinates(),current=subOrdinates[currentNo],currentOrder=document.getElementById("sub"+currentNo+"Order"),empty=Joomla.JText._("ORGANIZER_EMPTY_PANEL"),last=subOrdinates.length-1,requestedPosition=currentOrder.value,invalid=isNaN(requestedPosition)===true,tooHigh=requestedPosition>last,trailingBlank=requestedPosition===last&&current.name===empty;if(invalid||tooHigh||trailingBlank){currentOrder.value=currentNo;return}if(currentNo<requestedPosition){shiftDown(currentNo,requestedPosition,subOrdinates)}else{shiftUp(currentNo,requestedPosition,subOrdinates)}cloneSubOrdinate(requestedPosition,current)}function moveUp(currentNo){const subOrdinates=getSubOrdinates();let current,previous;if(currentNo<=1||subOrdinates.length===currentNo&&subOrdinates[currentNo-2].name===""){return}previous=subOrdinates[currentNo-1];current=subOrdinates[currentNo];cloneSubOrdinate(currentNo-1,current);cloneSubOrdinate(currentNo,previous)}function setFirst(currentNo){const subOrdinates=getSubOrdinates(),subOrdinate=subOrdinates[currentNo];if(subOrdinate.name!==""){shiftUp(currentNo,1,subOrdinates);cloneSubOrdinate(1,subOrdinate)}}function setLast(currentNo){const subOrdinates=getSubOrdinates(),last=subOrdinates.length-1,subOrdinate=subOrdinates[currentNo];if(subOrdinate.id!==""){shiftDown(currentNo,last,subOrdinates);cloneSubOrdinate(last,subOrdinate)}}function shiftDown(currentNo,stopNo,subOrdinates){currentNo=Number(currentNo);while(currentNo<stopNo){cloneSubOrdinate(currentNo,subOrdinates[currentNo+1]);currentNo++}}function shiftUp(currentNo,stopNo,subOrdinates){let newRow,sourceRow;while(currentNo>stopNo){newRow=currentNo;sourceRow=currentNo-1;cloneSubOrdinate(newRow,subOrdinates[sourceRow]);currentNo--}}function trash(currentNo){const subOrdinates=getSubOrdinates(),length=subOrdinates.length-1;shiftDown(currentNo,length,subOrdinates);document.getElementById("subRow"+length).remove()}